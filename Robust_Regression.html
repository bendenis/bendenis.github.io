<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Ben Denis Shaffer" />


<title>STATS_500_HW5</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="site_libs/ionicons-2.0.1/css/ionicons.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="ion ion-ios-pulse"></span>
     
    STATS 500
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about_stl1.html">About</a>
    </li>
    <li>
      <a href="SLR.html">Linear Regression</a>
    </li>
    <li>
      <a href="MLM.html">Multivariate Linear Regression</a>
    </li>
    <li>
      <a href="Diagnostics.html">Diagnostics</a>
    </li>
    <li>
      <a href="Robust_Regression.html">Robust Regression</a>
    </li>
    <li>
      <a href="Response_Transpormations.html">Response Transformations</a>
    </li>
    <li>
      <a href="Predictor_Transfromations.html">Predictor Transformations</a>
    </li>
    <li>
      <a href="Variable_Selection.html">Variable Selection</a>
    </li>
    <li>
      <a href="Dimensionality_Reduction.html">Dimonsionality Reduction</a>
    </li>
    <li class="dropdown-header">Regularization</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="ion ion-ios-pulse"></span>
     
    STATS 503
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Overview</li>
    <li>
      <a href="overview_503.html"></a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    STATS 506
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about_comp.html">About</a>
    </li>
    <li>
      <a href="STATS_506_HW_1.html">HW_1</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-map"></span>
     
    BIOSTAT 696
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about_spatial.html">About</a>
    </li>
    <li>
      <a href="BIOSTAT_1.html">PM 2.5 Concentrations</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://medium.com/@bendenisshaffer">
    <span class="fa fa-medium"></span>
     
    Blog
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/ben-denis-shaffer-16291140">
    <span class="fa fa-linkedin"></span>
     
    LinkedIn
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">STATS_500_HW5</h1>
<h4 class="author"><em>Ben Denis Shaffer</em></h4>
<h4 class="date"><em>November 3, 2016</em></h4>

</div>


<p>Here we will explore robust methods of regression and compare results to a regular regression analysis with diagnostics. The focus is on the question of how to best remedy outliers. The following is a snipet of the dataset being used.</p>
<table>
<thead>
<tr class="header">
<th align="right">Air.Flow</th>
<th align="right">Water.Temp</th>
<th align="right">Acid.Conc.</th>
<th align="right">stack.loss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">80</td>
<td align="right">27</td>
<td align="right">89</td>
<td align="right">42</td>
</tr>
<tr class="even">
<td align="right">80</td>
<td align="right">27</td>
<td align="right">88</td>
<td align="right">37</td>
</tr>
<tr class="odd">
<td align="right">75</td>
<td align="right">25</td>
<td align="right">90</td>
<td align="right">37</td>
</tr>
<tr class="even">
<td align="right">62</td>
<td align="right">24</td>
<td align="right">87</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="right">62</td>
<td align="right">22</td>
<td align="right">87</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="right">62</td>
<td align="right">23</td>
<td align="right">87</td>
<td align="right">18</td>
</tr>
</tbody>
</table>
<p>LS Model: Least squares</p>
<pre><code>## lm(formula = stack.loss ~ Air.Flow + Water.Temp + Acid.Conc.)</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">-39.9196744</td>
<td align="right">11.8959969</td>
<td align="right">-3.3557234</td>
<td align="right">0.0037503</td>
</tr>
<tr class="even">
<td>Air.Flow</td>
<td align="right">0.7156402</td>
<td align="right">0.1348582</td>
<td align="right">5.3066130</td>
<td align="right">0.0000580</td>
</tr>
<tr class="odd">
<td>Water.Temp</td>
<td align="right">1.2952861</td>
<td align="right">0.3680243</td>
<td align="right">3.5195672</td>
<td align="right">0.0026301</td>
</tr>
<tr class="even">
<td>Acid.Conc.</td>
<td align="right">-0.1521225</td>
<td align="right">0.1562940</td>
<td align="right">-0.9733098</td>
<td align="right">0.3440461</td>
</tr>
</tbody>
</table>
<p>LAD Model: Least absolute deviations</p>
<pre><code>## rq(formula = stack.loss ~ Air.Flow + Water.Temp + Acid.Conc.)</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">coefficients</th>
<th align="right">lower bd</th>
<th align="right">upper bd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">-39.6898551</td>
<td align="right">-41.6197317</td>
<td align="right">-29.6775352</td>
</tr>
<tr class="even">
<td>Air.Flow</td>
<td align="right">0.8318841</td>
<td align="right">0.5127787</td>
<td align="right">1.1411712</td>
</tr>
<tr class="odd">
<td>Water.Temp</td>
<td align="right">0.5739130</td>
<td align="right">0.3218235</td>
<td align="right">1.4108981</td>
</tr>
<tr class="even">
<td>Acid.Conc.</td>
<td align="right">-0.0608696</td>
<td align="right">-0.2134829</td>
<td align="right">-0.0289134</td>
</tr>
</tbody>
</table>
<p>Huber Model: Huber’s robust regression</p>
<pre><code>## rlm(formula = stack.loss ~ Air.Flow + Water.Temp + Acid.Conc.)</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Value</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">-41.0265311</td>
<td align="right">9.8073472</td>
<td align="right">-4.1832445</td>
</tr>
<tr class="even">
<td>Air.Flow</td>
<td align="right">0.8293739</td>
<td align="right">0.1111803</td>
<td align="right">7.4597166</td>
</tr>
<tr class="odd">
<td>Water.Temp</td>
<td align="right">0.9261082</td>
<td align="right">0.3034081</td>
<td align="right">3.0523516</td>
</tr>
<tr class="even">
<td>Acid.Conc.</td>
<td align="right">-0.1278492</td>
<td align="right">0.1288526</td>
<td align="right">-0.9922126</td>
</tr>
</tbody>
</table>
<p>LTS Model: Least trimmed squares</p>
<pre><code>## lqs.formula(formula = stack.loss ~ Air.Flow + Water.Temp + Acid.Conc., 
##     method = &quot;lts&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">m4$coefficients</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">-34.14583</td>
</tr>
<tr class="even">
<td>Air.Flow</td>
<td align="right">0.75000</td>
</tr>
<tr class="odd">
<td>Water.Temp</td>
<td align="right">0.25000</td>
</tr>
<tr class="even">
<td>Acid.Conc.</td>
<td align="right">0.00000</td>
</tr>
</tbody>
</table>
<p>The inferences on the results are not directly comparable, but we can directly compare the estimated coefficients. First we note that the coefficient for <code>Air.Flow</code> as well as the intercept don’t change dramatically. We would also suspect that <code>Air.Flow</code> is statistically significant based on all the regressions where a t-statistic of a confidence bound is available . Coefficient for <code>Water.Temp</code> does shrink noticeably, however the sign, and thus the qualitative interpretation would not change. This variable also seems significant. The qualitative interpretation of <code>Acid.Conc.</code> also doesn’t change except for the LTS method where the variable is effectively ignored. All in all the results are quite similar in terms of the qualitative interpretation of the coefficients, and also comparable in quantitative effect on the outcome in some cases.</p>
<p>Now we can try to improve our LS model by preforming diagnostics and taking appropriate measures. We will focus on the analysis of extreme points since the goal of robust regression methods is to remedy the extreme points.</p>
<p>First we look if there are point with high leverage</p>
<pre class="r"><code>halfnorm(lm.influence(m1)$hat)</code></pre>
<p><img src="Robust_Regression_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>cut = 2*(dim(stackloss)[2]+1)/dim(stackloss)[1]
sum(lm.influence(m1)$hat &gt; cut)</code></pre>
<pre><code>## [1] 0</code></pre>
<p>There appear to be some points with more leverage then others, like point 17, but no extreme values are observed. So, there don’t seem to be points with too high a leverage.</p>
<p>Next we test for outliers</p>
<pre class="r"><code>p_val &lt;- (1 - pt(abs(rstudent(m1)), nrow(stackloss) - ncol(stackloss - 1)))*2
plot(sort(p_val), ylab = &quot;p-value&quot;, main = &quot;Testing Outliers, Bonferroni Adjustment&quot;)
abline(h = 0.05/nrow(stackloss), col = 2, lty = 2)</code></pre>
<p><img src="Robust_Regression_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>sort(p_val)[1:2]</code></pre>
<pre><code>##          21           4 
## 0.003960491 0.055921682</code></pre>
<p>From the Bonferroni Adjusted test we see that point 21 would be considered an outlier. Bonferroni Adjustment is quite conservative however, so the second point could also be a suspect.</p>
<p>The next step would be to remove these two points (21,4) from the dataset and refit the LS model</p>
<pre class="r"><code>dts &lt;- stackloss[-c(4,21),]

m5 &lt;- lm(stack.loss ~ Air.Flow + Water.Temp + Acid.Conc., data = dts)
tb &lt;- as.data.frame(summary(m5)$coefficients)
summary(m5)$call</code></pre>
<pre><code>## lm(formula = stack.loss ~ Air.Flow + Water.Temp + Acid.Conc., 
##     data = dts)</code></pre>
<pre class="r"><code>kable(tb)</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">-42.4530806</td>
<td align="right">7.3845771</td>
<td align="right">-5.748884</td>
<td align="right">0.0000385</td>
</tr>
<tr class="even">
<td>Air.Flow</td>
<td align="right">0.9566048</td>
<td align="right">0.0944705</td>
<td align="right">10.125966</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td>Water.Temp</td>
<td align="right">0.5555707</td>
<td align="right">0.2640338</td>
<td align="right">2.104165</td>
<td align="right">0.0526410</td>
</tr>
<tr class="even">
<td>Acid.Conc.</td>
<td align="right">-0.1087661</td>
<td align="right">0.0967752</td>
<td align="right">-1.123904</td>
<td align="right">0.2787191</td>
</tr>
</tbody>
</table>
<p>Now when we compare the two LS models we see that the qualitative results are again the same. Now <code>Water.Temp</code> is less significant. The model without outliers however provides a better fit (<span class="math inline">\(R^2\)</span> increased to <code>0.9693</code> from <code>0.9136</code>) to the data. This is not necessarily good however. Furthermore if we look at the residual plots the problems of heteroskedastisity and possibly non-linearity remain, if not worsen. Without the outliers however the data does seem to follow the normal distribution more closely.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
